---
/** System: frase destacada con aparición ultra temprana */
const frase =
  "Ningún actor puede controlar el entorno sin igualarlo en complejidad; y si no puede igualarlo, debe aprender a domesticarlo.";
const autor = "Ross Ashby";
---

<section id="sistema" class="section">
  <div class="container">
    <div class="system-quote stage-item" data-stage="1">
      {frase} <span>— {autor}</span>
    </div>
  </div>

  <script is:inline>
    (function(){
      const section = document.getElementById('sistema');
      const items = section.querySelectorAll('.stage-item');

      // Umbrales: 20px para el primero (ultra pronto)
      const thresholds = Array.from(items).map((_, i) => 20 + i * 40);

      function onScroll(){
        const top = section.getBoundingClientRect().top + window.scrollY;
        const y   = window.scrollY || 0;
        items.forEach((el, i) => {
          if (y >= top + thresholds[i]) el.classList.add('is-on');
        });
      }
      onScroll();
      window.addEventListener('scroll', onScroll, { passive:true });
      window.addEventListener('resize', onScroll);
    })();
  </script>
</section>