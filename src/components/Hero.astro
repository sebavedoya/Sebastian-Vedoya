---
export interface Props {
  cv?: string;
  foto?: string;
}
const { cv, foto } = Astro.props;

const BASE = (import.meta.env.BASE_URL || "/").replace(/\/+$/, "");
const cvUrl = cv
  ? (/^https?:\/\//i.test(cv) ? cv : `${BASE}${cv.startsWith("/") ? cv : `/${cv}`}`)
  : `${BASE}/files/CV.pdf`;
const fotoUrl = foto
  ? (/^https?:\/\//i.test(foto) ? foto : `${BASE}${foto.startsWith("/") ? foto : `/${foto}`}`)
  : `${BASE}/assets/foto-hero.jpeg`;
---

<section id="inicio" class="hero hero-stage section section--flush-bottom" aria-label="Presentación">
  <div class="container hero-stage-grid">
    <div class="stage-panel">
      <h1 class="hero-title">
        Sebastián Vedoya M.
        <span class="hero-sub">Comunicación Estratégica</span>
      </h1>
      <p class="lead">
        Estratega en comunicación con más de 10 años de experiencia en medios y gobierno.
        Me dedico a buscar respuestas complejas para entornos complejos.
      </p>

      <!-- Foto -->
      <div class="photo-float js-stage" id="heroPhoto">
        <img src={fotoUrl} alt="Sebastián Vedoya M." loading="lazy" />
      </div>

      <!-- Contacto -->
      <div class="cta-row js-stage" id="heroContact">
        <a class="btn btn-outline" href={cvUrl} download>Descargar CV</a>
        <a class="chip" href="mailto:seba.vedoya@gmail.com">seba.vedoya@gmail.com</a>
        <a class="chip" href="https://www.linkedin.com/in/sebastianvedoyam/" target="_blank" rel="noopener">LinkedIn</a>
      </div>
    </div>
  </div>

  <canvas id="bg-net" aria-hidden="true"></canvas>

  <script is:inline>
    // Despliegue rápido: fade-in muy temprano
    const THRESH_PHOTO = 30;   // antes 60
    const THRESH_CONTACT = 80; // antes 140
    const elPhoto = document.getElementById('heroPhoto');
    const elContact = document.getElementById('heroContact');

    function applyStages(y){
      if (y >= THRESH_PHOTO) elPhoto.classList.add('is-on');
      else elPhoto.classList.remove('is-on');

      if (y >= THRESH_CONTACT) elContact.classList.add('is-on');
      else elContact.classList.remove('is-on');
    }

    window.addEventListener('scroll', ()=>applyStages(window.scrollY||0), { passive:true });
    applyStages(window.scrollY||0);
  </script>
</section>

<style>
.hero-stage {
  min-height: 88vh; /* antes 110vh → recortado */
}
.stage-panel {
  position: sticky;
  top: 10vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding: 8vh 0 3vh; /* menos padding inferior */
}
.photo-float {
  margin-top: 1.2rem;
  opacity: 0;
  transform: translateY(10px);
  transition: opacity .25s ease, transform .25s ease;
  filter: drop-shadow(0 16px 32px rgba(0,0,0,.45));
}
.photo-float.is-on { opacity: 1; transform: none; }

.photo-float img {
  width: 340px;
  height: 420px;
  object-fit: cover;
  object-position: center top;
  border-radius: 16px;
  border: 4px solid #0f1720;
  box-shadow: 0 10px 32px rgba(0,0,0,.55);
}

.cta-row {
  display: flex;
  gap: .75rem;
  flex-wrap: wrap;
  margin-top: 1rem;
  justify-content: center;
  opacity: 0;
  transform: translateY(6px);
  transition: opacity .25s ease, transform .25s ease;
}
.cta-row.is-on { opacity: 1; transform: none; }

@media (max-width: 1040px) {
  .photo-float img { width: 300px; height: 380px; }
}
@media (max-width: 640px) {
  .photo-float img { width: 260px; height: 320px; }
}
</style>