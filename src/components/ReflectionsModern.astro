---
/** ReflectionsModern: muestra las reflexiones en tarjetas limpias con modal completo */

const reflections = [
  {
    id: "ref-ashby",
    title: "La ley de la variedad requerida y el desafío comunicacional contemporáneo",
    dek: "Cómo el pensamiento de Ross Ashby anticipó los retos comunicacionales actuales.",
    body: `La ley de la variedad requerida, postulada por Ross Ashby en 1958, además de ser una de las piedras angulares de la cibernética, nos deja pertinentes lecciones para afrontar el entorno comunicativo actual.

Según el psiquiatra inglés, un sistema solo puede sobrevivir y mantenerse estable si su capacidad de respuestas al menos iguala a las perturbaciones que provienen de su entorno. En términos comunicacionales, es imposible controlar el entorno sin al menos igualarlo en complejidad, y si no puede igualar, debe aprender a domesticarlo.

Nos encontramos en una era en donde la variedad inunda el entorno a través de innumerables canales, audiencias y especializaciones. Aplicando la lección de Ashby, la ausencia no resuelve conflictos: más bien exige que las estrategias planifiquen y conduzcan a través de variados canales y mensajes que los contrarresten.`
  },
  {
    id: "ref-autoridades",
    title: "Autoridades y redes sociales: una confusión frecuente",
    dek: "Por qué las redes institucionales no son extensiones personales del liderazgo.",
    body: `Pese a lo que muchas autoridades creen, las redes sociales institucionales no son su canal de noticias 24/7, ni un espacio para posicionar su figura personal. Son plataformas de comunicación pública y de servicio ciudadano, donde la transparencia y la utilidad del mensaje priman sobre la autopromoción.

Confundir la cuenta institucional con la personal genera desbalance comunicacional, erosiona la credibilidad y debilita el relato colectivo. La comunicación pública debe sostener un tono coherente, profesional y empático, que fortalezca la confianza hacia la institución, no hacia un individuo.`
  },
  {
    id: "ref-miedo",
    title: "Comunicar sin miedo",
    dek: "El valor de la autenticidad y la claridad en tiempos de desconfianza.",
    body: `Durante una visita a Rapa Nui tuve la oportunidad de entrevistar a la alcaldesa Elizabeth Arévalo Pakarati. Culminada la conversación, mi reacción fue inmediata: ya quisiera cualquier político o directivo su capacidad de comunicar. Todo era preciso: su tono, su postura, su vestimenta y su locuacidad.

Su puesta en escena demostraba trabajo, pero también naturalidad. Irradiaba seguridad, no impostación. Su ejemplo no solo sirve como reconocimiento, sino también como contraste con el temor y la desconfianza con que muchas autoridades enfrentan la responsabilidad de comunicar. Comunicar sin miedo es, en esencia, comunicar con verdad.`
  }
];
---

<section id="reflexiones" class="section">
  <div class="container">
    <h2 class="h2">Reflexiones</h2>
    <p class="section-intro">Análisis y experiencias sobre comunicación, estrategia y complejidad.</p>

    <div class="r-grid">
      {reflections.map((r) => (
        <article class="r-card reveal" id={r.id}>
          <div class="r-body">
            <h3 class="r-title">{r.title}</h3>
            <p class="r-dek">{r.dek}</p>
            <button class="btn-outline r-btn" data-open={r.id}>Leer completa</button>
          </div>

          {/* Modal */}
          <dialog class="r-modal" id={`dlg-${r.id}`} aria-labelledby={`title-${r.id}`}>
            <form method="dialog" class="r-close-wrap">
              <button class="r-close" aria-label="Cerrar">✕</button>
            </form>
            <div class="r-modal-content">
              <h3 id={`title-${r.id}`}>{r.title}</h3>
              <p class="r-text" style="white-space:pre-wrap">{r.body}</p>
            </div>
          </dialog>
        </article>
      ))}
    </div>
  </div>

  <script is:inline>
    document.querySelectorAll('.r-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const id = btn.getAttribute('data-open');
        const dlg = document.getElementById('dlg-' + id);
        if (!dlg) return;
        dlg.showModal();
      });
    });

    document.querySelectorAll('.r-modal').forEach(dlg => {
      dlg.addEventListener('click', e => {
        const rect = dlg.getBoundingClientRect();
        const clickedBackdrop = e.clientX < rect.left || e.clientX > rect.right || e.clientY < rect.top || e.clientY > rect.bottom;
        if (clickedBackdrop) dlg.close();
      });
      dlg.addEventListener('cancel', e => { e.preventDefault(); dlg.close(); });
    });
  </script>
</section>

<style>
  .r-grid {
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
    gap:1.5rem;
  }
  .r-card {
    background:#161b22;
    border:1px solid #222a33;
    border-radius:18px;
    box-shadow:0 8px 28px rgba(0,0,0,.4);
    padding:1.4rem;
    transition:transform .25s ease, box-shadow .25s ease;
  }
  .r-card:hover { transform:translateY(-3px); box-shadow:0 12px 32px rgba(0,0,0,.5); }

  .r-title { margin:0 0 .4rem; font-size:1.15rem; color:#eaf2f8; }
  .r-dek { color:#cbd5e1; margin:0 0 1rem; }
  .r-btn { font-weight:700; }

  /* Modal */
  .r-modal {
    width:min(880px,94vw);
    border:none;
    border-radius:20px;
    background:rgba(14,20,26,0.92);
    backdrop-filter:blur(8px);
    color:#e6eef4;
    box-shadow:0 25px 120px rgba(0,0,0,.7);
    padding:2rem;
  }
  .r-modal::backdrop {
    background:rgba(0,0,0,0.7);
    backdrop-filter:blur(4px);
    transition:opacity .3s ease;
  }
  .r-close-wrap { position:absolute; top:12px; right:12px; }
  .r-close {
    border:1px solid #263242;
    background:#111a23;
    color:#e6eef4;
    width:36px;
    height:36px;
    border-radius:50%;
    cursor:pointer;
  }
  .r-modal-content {
    max-height:80vh;
    overflow-y:auto;
  }
  .r-modal-content h3 {
    margin-top:0;
    margin-bottom:.75rem;
    font-size:1.3rem;
  }
  .r-text {
    color:#c9d3df;
    line-height:1.7;
    font-size:1.05rem;
  }
</style>