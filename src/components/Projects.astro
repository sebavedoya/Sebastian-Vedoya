---
/** Proyectos: tarjetas con entrada por scroll rápido, escalonadas */
const items = [
  {
    id: "proj-topografo",
    title: "Operación Topógrafo – Investigación periodística sobre espionaje militar",
    body: `Reportaje de investigación que reveló el espionaje de la Dirección de Inteligencia del Ejército a periodistas y funcionarios denunciantes...`
  },
  {
    id: "proj-vocerias",
    title: "Asesoría comunicacional – Vocerías y despliegue nacional",
    body: `He recorrido las 16 regiones del país... fortalecer las vocerías, orientar ante crisis y consolidar la coherencia...`
  },
  {
    id: "proj-redes",
    title: "Comunicación digital adaptada al estilo de redes sociales",
    body: `He conducido equipos con el propósito de reorientar las comunicaciones digitales institucionales...`
  }
];
---

<section id="proyectos" class="section">
  <div class="container">
    <h2 class="h2">Proyectos</h2>

    <div class="grid cards">
      {items.map((p, i) => (
        <article class="card stage-item" data-stage={i+1} id={p.id}>
          <header class="card-head">
            <span class="icon">0{String(i+1)}</span>
            <h3 class="h3" style="margin:0">{p.title}</h3>
          </header>
          <p class="card-text">{p.body}</p>
        </article>
      ))}
    </div>
  </div>

  <script is:inline>
    // Aparición rápida y escalonada (sin IO, con scrollY)
    (function(){
      const section = document.getElementById('proyectos');
      const items   = section.querySelectorAll('.stage-item');
      const base = Math.min(window.innerHeight * 0.10, 100);
      // cada tarjeta entra con +80px respecto de la anterior
      const thresholds = Array.from(items).map((_,i)=> (i*80) + Math.max(20, base*0.6));

      function onScroll(){
        const top = section.getBoundingClientRect().top + window.scrollY;
        const y   = window.scrollY || 0;
        items.forEach((el, i)=>{
          if (y > top - 20 + thresholds[i]) el.classList.add('is-on');
          else el.classList.remove('is-on');
        });
      }
      onScroll();
      window.addEventListener('scroll', onScroll, { passive:true });
      window.addEventListener('resize', onScroll);
    })();
  </script>
</section>