---
/** Proyectos: entrada casi inmediata y escalonada muy corta */
const items = [
  {
    id: "proj-topografo",
    title: "Operación Topógrafo – Investigación periodística sobre espionaje militar",
    body: `Reportaje de investigación que reveló el espionaje de la Dirección de Inteligencia del Ejército a periodistas y funcionarios denunciantes...`
  },
  {
    id: "proj-vocerias",
    title: "Asesoría comunicacional – Vocerías y despliegue nacional",
    body: `He recorrido las 16 regiones del país... fortalecer las vocerías, orientar ante crisis y consolidar la coherencia...`
  },
  {
    id: "proj-redes",
    title: "Comunicación digital adaptada al estilo de redes sociales",
    body: `He conducido equipos con el propósito de reorientar las comunicaciones digitales institucionales...`
  }
];
---

<section id="proyectos" class="section">
  <div class="container">
    <h2 class="h2">Proyectos</h2>

    <div class="grid cards">
      {items.map((p, i) => (
        <article class="card stage-item" data-stage={i+1} id={p.id}>
          <header class="card-head">
            <h3 class="h3" style="margin:0">{p.title}</h3>
          </header>
          <p class="card-text">{p.body}</p>
        </article>
      ))}
    </div>
  </div>

  <script is:inline>
    (function(){
      const section = document.getElementById('proyectos');
      const items = section.querySelectorAll('.stage-item');

      // Umbrales ultra cortos: primero a 20px, luego +40px cada uno
      const thresholds = Array.from(items).map((_, i) => 20 + i * 40);

      function onScroll(){
        const top = section.getBoundingClientRect().top + window.scrollY;
        const y   = window.scrollY || 0;
        items.forEach((el, i) => {
          if (y >= top + thresholds[i]) el.classList.add('is-on');
        });
      }
      onScroll();
      window.addEventListener('scroll', onScroll, { passive:true });
      window.addEventListener('resize', onScroll);
    })();
  </script>
</section>