---
/** Prensa: cards con aparición temprana */
const notas = [
  {
    medio: "La Tercera",
    titulo: "Operación Topógrafo — Espionaje del Ejército a denunciantes",
    url: "https://www.latercera.com/reportajes/noticia/operacion-topografo-espionaje-del-ejercito-cuatro-denunciantes-irregularidades/777342/",
    img: "/assets/prensa/topografo.jpg",
  },
  {
    medio: "Publimetro",
    titulo: "Ricardo Lagos: “Durante mi gobierno no privaticé nada, al contrario”",
    url: "https://www.publimetro.cl/cl/noticias/2016/11/18/ex-presidente-lagos-durante-mi-gobierno-no-privatice-nada-contrario.html",
    img: "/assets/prensa/lagos.jpg",
  },
  {
    medio: "Publimetro",
    titulo: "Sebastián Piñera: “Me siento orgulloso de lo que he logrado en la vida”",
    url: "https://www.publimetro.cl/cl/noticias/2017/06/19/sebastian-pinera-me-siento-orgulloso-lo-he-logrado-vida.html",
    img: "/assets/prensa/pinera.jpg",
  },
  {
    medio: "La Tercera",
    titulo: "Hernán Larraín: “No somos partidarios de indultar a violadores de DD.HH. ni asesinos en serie”",
    url: "https://www.latercera.com/nacional/noticia/hernan-larrain-ministro-justicia-derechos-humanos-no-somos-partidarios-indultar-violadores-dd-hh-asesinos-serie/111533/",
    img: "/assets/prensa/larrain.jpg",
  }
];

const BASE = (import.meta.env.BASE_URL || "/").replace(/\/+$/, "");
const srcFor = (p?: string) => p ? (/^https?:\/\//i.test(p) ? p : `${BASE}${p.startsWith("/") ? p : `/${p}`}`) : undefined;
---

<section id="prensa" class="section">
  <div class="container">
    <h2 class="h2">Prensa</h2>

    <div class="grid cards">
      {notas.map((n, i) => {
        const src = srcFor(n.img);
        return (
          <a class="card press stage-item" data-stage={i+1} href={n.url} target="_blank" rel="noopener">
            {src ? (
              <figure class="thumb" style="aspect-ratio:16/9;overflow:hidden;border-radius:.6rem;margin-bottom:.5rem;background:#0f141a">
                <img src={src} alt={n.titulo} loading="lazy" style="width:100%;height:100%;object-fit:cover;display:block" />
              </figure>
            ) : (
              <div class="thumb placeholder" aria-hidden="true" />
            )}
            <div class="meta">
              <span class="tag" style="font-size:.85rem;color:#9aa8b8">{n.medio}</span>
              <h3 class="h3" style="margin:.25rem 0 0;line-height:1.4">{n.titulo}</h3>
            </div>
          </a>
        );
      })}
    </div>
  </div>

  <script is:inline>
    (function(){
      const section = document.getElementById('prensa');
      const items = section.querySelectorAll('.stage-item');
      const thresholds = Array.from(items).map((_, i) => 20 + i * 40);

      function onScroll(){
        const top = section.getBoundingClientRect().top + window.scrollY;
        const y   = window.scrollY || 0;
        items.forEach((el, i) => {
          if (y >= top + thresholds[i]) el.classList.add('is-on');
        });
      }
      onScroll();
      window.addEventListener('scroll', onScroll, { passive:true });
      window.addEventListener('resize', onScroll);
    })();
  </script>
</section>